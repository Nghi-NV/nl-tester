name: audio_ducking_test

---
  # 1. Phát nhạc nền từ file đã tạo
  - playMedia:
      file: resources/audio/test_tone_440hz.mp3
      loop: true
  - wait: 3000
  # 2. Bắt đầu capture audio (30s)
#   - startAudioCapture:
#       duration: 30000
#       port: 8890

  - wait: 3000

  # 3. Chạy Mock Location
  # - Bắt đầu 30 km/h (bình thường)
  - mockLocation:
      name: route1
      file: Location.gpx
      speed: 30.0
      loop: false

  - wait: 3000

  # - Tăng lên 80 km/h (>50 km/h) -> Trigger Gofa alert + Audio Ducking
  - mockLocationControl:
      name: route1
      speed: 80.0
      speedMode: linear

  # - Chờ để capture được sự kiện ducking (cảnh báo + giảm volume)
  - wait: 15000

  # 4. Dừng media và location
  - stopMedia
  - stopMockLocation

  # 5. Verify kết quả (Log ra console)
  - verifyAudioDucking:
      minDuckingCount: 1
      volumeDropThreshold: 20.0
